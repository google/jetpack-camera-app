#!/bin/sh

echo "Running Spotless check before push..."

# Run the spotlessCheck command. If it fails, print a helpful message and exit.
if ! ./gradlew spotlessCheck --init-script gradle/init.gradle.kts; then
    echo "--------------------------------------------------"
    echo "ERROR: Spotless check failed."
    echo "Your code is not formatted correctly."
    echo ""
    echo "Please run the following command to fix it:"
    echo "  ./gradlew spotlessApply --init-script gradle/init.gradle.kts"
    echo ""
    echo "Then, stage the changes and amend your commit before pushing."
    echo "--------------------------------------------------"
    # Exit with a non-zero status to abort the push
    exit 1
fi

echo "Spotless check passed. Proceeding with push."
exit 0
